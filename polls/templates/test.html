<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apple RCA Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root {
            --apple-bg: #f5f5f7;
            --glass: rgba(255, 255, 255, 0.75);
            --glass-border: rgba(255, 255, 255, 0.9);
            --blue: #007aff;
            --yellow: #ff9f0a;
            --green: #34c759;
            --purple: #5856d6;
            --red: #ff3b30;
            --text-main: #1d1d1f;
            --text-sec: #86868b;
        }

        body {
            background-color: var(--apple-bg);
            color: var(--text-main);
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "Helvetica Neue", sans-serif;
            margin: 0;
            padding: 40px 0;
        }

        .dashboard-container {
            max-width: 1140px;
            margin: auto;
            position: relative;
        }

        /* Apple Glass Card */
        .apple-card {
            background: var(--glass);
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border-radius: 18px;
            border: 1px solid var(--glass-border);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.03);
            margin-bottom: 24px;
            overflow: hidden;
            position: relative;
            z-index: 2;
        }

        /* Table Styling */
        .apple-table thead th {
            background: rgba(0,0,0,0.02);
            color: var(--text-sec);
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            padding: 12px 20px;
            border: none;
        }

        .apple-table tbody td {
            padding: 15px 20px;
            border-bottom: 1px solid rgba(0,0,0,0.03);
            vertical-align: middle;
        }

        .apple-table tr:hover { background: rgba(0, 122, 255, 0.03); }

        /* Flow Indicators */
        .indicator-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }

        /* Connector SVG */
        #flow-canvas {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .connector {
            fill: none;
            stroke: rgba(0, 0, 0, 0.08);
            stroke-width: 2;
            stroke-dasharray: 4; /* Optional: makes lines look like a path */
        }

        /* Search & Button */
        .apple-input {
            background: rgba(0,0,0,0.05);
            border: 1px solid transparent;
            border-radius: 10px;
            padding: 10px 18px;
            width: 300px;
            transition: 0.2s;
        }
        .apple-input:focus { background: #fff; border-color: var(--blue); outline: none; }
        
        .btn-analyze {
            background: var(--blue);
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 10px;
            font-weight: 600;
        }
    </style>
</head>
<body>

<div class="dashboard-container" id="main-canvas">
    <svg id="flow-canvas">
        <path id="line1" class="connector" />
        <path id="line2" class="connector" />
        <path id="line3" class="connector" />
    </svg>

    <header class="d-flex justify-content-between align-items-center mb-5 px-3">
        <div>
            <h1 class="h3 fw-bold mb-0">Root Cause Analysis</h1>
            <p class="text-secondary small">Service ID: APP-123 â€¢ Session Active</p>
        </div>
        <div class="d-flex gap-2">
            <input type="text" class="apple-input" value="APP-123" placeholder="Enter App ID...">
            <button class="btn-analyze">Analyze</button>
        </div>
    </header>

    <section class="px-3 mb-5">
        <div class="apple-card">
            <div class="p-3 border-bottom d-flex justify-content-between">
                <span class="fw-bold small">Incident & Change Log</span>
                <span class="text-secondary small">Showing last 3 activities</span>
            </div>
            <div class="table-responsive">
                <table class="table apple-table mb-0">
                    <thead>
                        <tr>
                            <th>Incident Number</th>
                            <th>Short Description</th>
                            <th>Change ID</th>
                            <th>Deployment Date</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="fw-bold text-primary">INC0123456</td>
                            <td class="small">Auth timeout in US-East-1</td>
                            <td><code class="text-dark">CHG007890</code></td>
                            <td class="text-secondary small">Jan 06, 2026 14:15</td>
                            <td><span class="badge rounded-pill bg-danger bg-opacity-10 text-danger">Critical</span></td>
                        </tr>
                        <tr>
                            <td class="fw-bold text-primary">INC0123448</td>
                            <td class="small">Latency spike on DB Node 03</td>
                            <td><code class="text-dark">CHG000542</code></td>
                            <td class="text-secondary small">Jan 05, 2026 09:20</td>
                            <td><span class="badge rounded-pill bg-success bg-opacity-10 text-success">Resolved</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </section>

    <section class="row g-4 px-3 position-relative">
        <div class="col-md-5">
            <div id="node-inc" class="apple-card p-4">
                <div class="small text-secondary fw-bold mb-1">CURRENT INCIDENT</div>
                <h2 class="fw-bold" style="color: var(--blue);">INC0123456</h2>
            </div>
        </div>

        <div class="col-md-6 offset-md-1">
            <div id="node-diag" class="apple-card p-4">
                <div class="small text-secondary fw-bold mb-1">DIAGNOSIS</div>
                <p class="mb-0">Deployment <b>CHG007890</b> triggered a connection leak in the Login microservice.</p>
            </div>
        </div>

        <div class="col-md-4">
            <div id="node-nodes" class="apple-card p-4">
                <div class="small text-secondary fw-bold mb-2">AFFECTED NODES</div>
                <div class="small"><span class="indicator-dot" style="background: var(--purple);"></span> APP-SRV-01</div>
                <div class="small mt-2"><span class="indicator-dot" style="background: var(--purple);"></span> DB-SRV-03</div>
            </div>
        </div>

        <div class="col-md-7">
            <div id="node-logs" class="apple-card p-4 border-start border-danger border-4">
                <div class="small text-danger fw-bold mb-2">CRITICAL LOG ERRORS</div>
                <pre class="mb-0 small text-danger" style="font-family: 'SF Mono', monospace;">
[14:31:02] ERROR: User authentication failed.
[14:34:05] ERROR: DB connection pool exhausted.
[14:35:11] FATAL: NullPointerException in LoginService.java:57</pre>
            </div>
        </div>
    </section>
</div>

<script>
    function drawConnectors() {
        const container = document.getElementById('main-canvas').getBoundingClientRect();
        const getBox = (id) => {
            const el = document.getElementById(id);
            const r = el.getBoundingClientRect();
            return {
                x: r.left - container.left + (r.width / 2),
                y: r.top - container.top + (r.height / 2),
                right: r.right - container.left,
                left: r.left - container.left,
                top: r.top - container.top,
                bottom: r.bottom - container.top
            };
        };

        const inc = getBox('node-inc');
        const diag = getBox('node-diag');
        const nodes = getBox('node-nodes');
        const logs = getBox('node-logs');

        // Line 1: Incident -> Diagnosis
        document.getElementById('line1').setAttribute('d', `M ${inc.right} ${inc.y} L ${diag.left} ${diag.y}`);
        
        // Line 2: Incident -> Nodes (Curve)
        document.getElementById('line2').setAttribute('d', `M ${inc.x} ${inc.bottom} Q ${inc.x} ${nodes.top} ${nodes.x} ${nodes.top}`);
        
        // Line 3: Nodes -> Logs (Curve)
        document.getElementById('line3').setAttribute('d', `M ${nodes.right} ${nodes.y} C ${nodes.right + 50} ${nodes.y}, ${logs.left - 50} ${logs.y}, ${logs.left} ${logs.y}`);
    }

    window.addEventListener('load', drawConnectors);
    window.addEventListener('resize', drawConnectors);
</script>

</body>
</html>